subscribes: order.finalize
publishes: order.finalized

activities:

  finalizer:
    title: Finalize Routed Order
    type: trigger
    output:
      schema:
        $ref: '../schemas/order.finalize.yaml#/order'
      maps:
        $ref: '../maps/order.finalize.yaml#/finalizer/output'
    stats:
      granularity: 5m
      id: '{$self.input.data.id}'
      key: static

  bundler:
    title: Bundle Routed Order
    type: exec
    subtype: order.bundle
    input:
      schema:
        $ref: '../schemas/order.finalize.yaml#/order'
      maps:
        $ref: '../maps/order.finalize.yaml#/bundler/input'

transitions:
  finalizer:
    - to: bundler
